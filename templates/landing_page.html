{% extends "base.html" %}
{% block main_content %}

	<style>
		.theengirls-border-right{
			border-right: 5px solid rgba(28,110,164,0.09);
			border-radius: 0px 22px 0px 0px;
		}
		.theengirls-border-bottom {
		
			border-bottom: 5px solid rgba(28,110,164,0.09);
			border-radius: 0px 22px 0px 0px;

		}
		.sub-button, .sub-button:active, .sub-button:focus{
        outline: none; 

   		}
	</style>
	<div class = "container-fluid">
		<div class = "row">
			<div class = "col-sm-12">
				<div class = "page-header engirls_font_large"> 
					<div class = "text-center well">
						<h1>Welcome to The Engirls</h1>				
					</div> 
				</div>
				
			</div>			
		</div>
		
		<div class = "row" style = "overflow: hidden;">
			<!-- Custom content goes here -->
			<div class = "col-sm theengirls-border-right" id="center-me">
				{{ content.body | safe}}
			</div>

			<div class = "col-sm engirls_font_norm" id="my_subscribe" style= "width: 100% !important;">
				<div class = "container-fluid" name = "Subscription_Container">
					<div class = "">
						<div class = "row" style = "max-width: 100%;">
							<a class = "sub-button" data-toggle="collapse" href="#id_subscribe_form" aria-expanded="true" aria-controls="id_subscribe_form" style = "color:inherit;">
								<div class = "theengirls-border-right mr-2">
									<img src="https://img.icons8.com/bubbles/100/000000/email.png"/>
									<div id= "id_sign_up" class = "pr-2"> Sign up for our news letter </div>
								</div>
							</a>
						</div>
						<div class = "row" style = "max-width: 100%;">
							<div class = "collapse" id = "id_subscribe_form">
								<form action = "{% url 'subscriptions:submit_subscription' %}" method="POST"> 
									
									{% csrf_token %}
									{% for field in subscription_form %}
										 {{ field.errors }}
										 {{ field.label }}
										 {{ field }}
									{% endfor %}
									

									<button id = "id_subscribe_button" class= "button-submit btn-outline-dark btn-sm">Subscribe !</button>
								</form>
							</div>
						</div>
						<div class = "row">
							<div id = "id_form_response" class ="the_engirls_fonr_norm"> </div>
						</div>
					</div>

				</div>
			</div>

		</div>
	</div>


<script>

/** 
	Submit subscribe button
**/
$("#id_subscribe_button").on('click', function(e) {
    e.preventDefault();
    var form = $(this).closest("form");
     $.ajax({
            url: '/subscriptions/submit_subscription/',
            type: 'POST',
            data: form.serialize()
        }).done(function(data){
        	// Set email forum to none
        	$("#id_email").val("");

        	$("#id_subscribe_form").toggle();
        	// Display response message
        	$.each( data, function( key, val ) {
        		$("#id_form_response").text(val);
        	});
        });
      return false;
  });

/**
	Realign the Subscribe button
**/
function realign_subscribe() {
  // push the subscribe button further back, if inside the center me div
  var sub_position = $("#my_subscribe").position();
  var center_position = $("#center-me").position();

  // right most point of the center div
  var center_position_right = center_position.left + $("#center-me").outerWidth(true);
  
  // If the subscribe button is inside the center image...
  if(sub_position.left < center_position_right && sub_position.top <= center_position.top) {

  	// Make sure resizing doesn't bring us out of the window...
		$("#my_subscribe").css("left", (center_position_right - sub_position.left ) + "px");
  }
}

/*
	Center the custom content to be in the center of the page
*/
function center_custom_content() {
  $("#center-me").css("left", Math.max(0, (($(window).width() - $("#center-me").outerWidth()) / 2) + 
                                                $(window).scrollLeft()) + "px");
}

/*
	On Document Ready
*/
$(document).ready(function(){
	  // Make sure images aren't oversized
	  $("img").addClass("img-fluid");

	 center_custom_content();
	 realign_subscribe();


	 $("#id_email").val();

	  // If the window is resized, 
	  // reconfigure the center content and subscribe button
	$(window).on('resize',function(){
		center_custom_content();
		realign_subscribe();
	});



});
</script>
{% endblock %}
{% block footer %}
    {% include "footer.html" %}
{% endblock %}